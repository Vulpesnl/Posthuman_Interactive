<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Electrónica y Programación - Post Human Interactive</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="mediaqueries.css" />
    <!-- Añadir p5.js para el proyecto Blink Void -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.10.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.10.0/addons/p5.sound.min.js"></script>
    <!-- Font Awesome para iconos -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body style="background-color: #121113">
    <nav id="desktop-nav">
      <div class="logo"><img src="./assets/logotipo.png" alt="Logotipo" /></div>
      <div>
        <ul class="nav-links">
          <li><a href="index.html#about">Sobre mí</a></li>
          <li><a href="index.html#experience">Habilidades</a></li>
          <li><a href="index.html#projects">Proyectos</a></li>
          <li><a href="index.html#contact">Contacto</a></li>
        </ul>
      </div>
    </nav>
    <nav id="hamburger-nav">
      <div class="logo"><img src="./assets/logotipo.png" alt="Logotipo" /></div>
      <div class="hamburger-menu">
        <div class="hamburger-icon" onclick="toggleMenu()">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <div class="menu-links">
          <li>
            <a href="index.html#about" onclick="toggleMenu()">Acerca de mí</a>
          </li>
          <li>
            <a href="index.html#experience" onclick="toggleMenu()"
              >Experiencia</a
            >
          </li>
          <li>
            <a href="index.html#projects" onclick="toggleMenu()">Proyectos</a>
          </li>
          <li>
            <a href="index.html#contact" onclick="toggleMenu()">Contacto</a>
          </li>
        </div>
      </div>
    </nav>

    <section id="project-details">
      <p class="section__text__p1">Categoría</p>
      <h1 class="title">Electrónica y Programación</h1>

      <!-- Proyecto 1: Blink Void -->
      <div class="project-content">
        <div class="project-image">
          <div
            id="blink-void-container"
            style="
              width: 100%;
              height: 400px;
              border-radius: 1rem;
              overflow: hidden;
              position: relative;
            "
          >
            <button
              id="mute-button"
              style="
                position: absolute;
                bottom: 10px;
                right: 10px;
                z-index: 100;
                background-color: rgba(0, 0, 0, 0.5);
                color: white;
                border: none;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                cursor: pointer;
                display: flex;
                justify-content: center;
                align-items: center;
              "
            >
              <i
                id="mute-icon"
                class="fas fa-volume-up"
                style="font-size: 18px"
              ></i>
            </button>
          </div>
        </div>
        <div class="project-description">
          <h2>Blink Void</h2>
          <p>
            Blink Void es una animación interactiva creada con la librería p5.js
            que responde al clic del usuario. La animación representa un ojo
            hipnótico que parpadea cuando el usuario hace clic sobre él,
            acompañado de efectos sonoros.
          </p>
          <p>
            Este proyecto explora la interactividad básica y la sincronización
            de elementos visuales con audio, creando una experiencia inmersiva y
            reactiva. La animación utiliza funciones matemáticas como seno y
            coseno para generar movimientos orgánicos y fluidos que simulan un
            portal o vacío en constante movimiento.
          </p>
          <p style="color: #9b1d20">
            <br />
            <strong>Interacción:</strong> Haz clic sobre el ojo
          </p>
        </div>
      </div>

      <!-- Proyecto 2: Lotófago -->
      <div class="project-content">
        <div class="project-image">
          <img
            src="./assets/proyectos/Programación y electrónica/Lotofágos/portada_lotofago.png"
            alt="Proyecto Lotófago"
          />
        </div>
        <div class="project-description">
          <h2>Lotófago</h2>
          <p>
            Lotófago es un juego de reacción desarrollado con Arduino que
            desafía los reflejos y la concentración de los jugadores. Inspirado
            en el concepto mitológico de los lotófagos (comedores de loto), el
            juego sumerge a los participantes en un estado de concentración
            similar al trance.
          </p>
          <p>
            El sistema utiliza sensores, luces LED y componentes electrónicos
            para crear una experiencia de juego física e inmersiva. Los
            jugadores deben reaccionar rápidamente a estímulos visuales,
            presionando botones en el momento preciso para acumular puntos.
          </p>
          <p>
            Este proyecto combina programación en Arduino, diseño de circuitos
            electrónicos y conceptualización de mecánicas de juego para crear
            una experiencia interactiva única.
          </p>
          <!-- Video de montaje funcionamiento -->
          <div style="margin-top: 20px;">
            <h3>Demostración del funcionamiento:</h3>
            <video width="100%" controls poster="./assets/proyectos/Programación y electrónica/Lotofágos/1747947593952.jpg">
              <source src="./assets/proyectos/Programación y electrónica/Lotofágos/montaje funcionamiento.mp4" type="video/mp4">
              Tu navegador no soporta videos HTML5.
            </video>
          </div>
        </div>
      </div>

      <div class="project-gallery">
        <h2>Galería - Lotófago</h2>
        <div class="gallery-container">
          <!-- Imágenes del proyecto -->
          <div class="gallery-item">
            <img
              src="./assets/proyectos/Programación y electrónica/Lotofágos/01_montaje_final.jpg"
              alt="Lotófago - Montaje final"
            />
            <p>Montaje final del circuito</p>
          </div>
          <div class="gallery-item">
            <img
              src="./assets/proyectos/Programación y electrónica/Lotofágos/02_Modulos_arduino.jpg"
              alt="Lotófago - Módulos Arduino"
            />
            <p>Módulos Arduino</p>
          </div>
          <div class="gallery-item">
            <img
              src="./assets/proyectos/Programación y electrónica/Lotofágos/03_prototipado.jpg"
              alt="Lotófago - Prototipado"
            />
            <p>Proceso de prototipado</p>
          </div>
          <div class="gallery-item">
            <img
              src="./assets/proyectos/Programación y electrónica/Lotofágos/06_diseño_de_tablero_1.jpg"
              alt="Lotófago - Diseño de tablero 1"
            />
            <p>Diseño del tablero - Vista 1</p>
          </div>
          <div class="gallery-item">
            <img
              src="./assets/proyectos/Programación y electrónica/Lotofágos/07_diseño_de_tablero_2.jpg"
              alt="Lotófago - Diseño de tablero 2"
            />
            <p>Diseño del tablero - Vista 2</p>
          </div>
          <div class="gallery-item">
            <img
              src="./assets/proyectos/Programación y electrónica/Lotofágos/diagrama.png"
              alt="Lotófago - Diagrama"
            />
            <p>Diagrama del sistema</p>
          </div>
          <!-- Videos del proyecto -->
          <div class="gallery-item video-item">
            <video
              poster="./assets/proyectos/Programación y electrónica/Lotofágos/04_prototipo.mp4"
              preload="metadata"
            >
              <source
                src="./assets/proyectos/Programación y electrónica/Lotofágos/04_prototipo.mp4"
                type="video/mp4"
              />
            </video>
            <p>Prototipo en funcionamiento</p>
          </div>
          <div class="gallery-item video-item">
            <video
              poster="./assets/proyectos/Programación y electrónica/Lotofágos/05_luces_rgb.mp4"
              preload="metadata"
            >
              <source
                src="./assets/proyectos/Programación y electrónica/Lotofágos/05_luces_rgb.mp4"
                type="video/mp4"
              />
            </video>
            <p>Demostración de luces RGB</p>
          </div>
          <div class="gallery-item video-item">
            <video
              poster="./assets/proyectos/Programación y electrónica/Lotofágos/08_modulos_luces.mp4"
              preload="metadata"
            >
              <source
                src="./assets/proyectos/Programación y electrónica/Lotofágos/08_modulos_luces.mp4"
                type="video/mp4"
              />
            </video>
            <p>Módulos de luces en funcionamiento</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal para visualización de imágenes y videos -->
    <div id="imageModal" class="modal">
      <span class="close">&times;</span>
      <span class="nav-btn prev">&lsaquo;</span>
      <span class="nav-btn next">&rsaquo;</span>
      <img class="modal-content" id="modalImage" />
      <video
        class="modal-content"
        id="modalVideo"
        controls
        style="display: none"
      ></video>
    </div>

    <footer>
      <nav>
        <div class="nav-links-container">
          <ul class="nav-links">
            <li><a href="index.html#about">Sobre mí</a></li>
            <li><a href="index.html#experience">Habilidades</a></li>
            <li><a href="index.html#projects">Proyectos</a></li>
            <li><a href="index.html#contact">Contacto</a></li>
          </ul>
        </div>
      </nav>
      <p>&#169; 2025 Alexis Posada.</p>
    </footer>

    <!-- Script para la animación de Blink Void -->
    <script>
      // Código adaptado del sketch.js original para funcionar en un contenedor específico
      let blinkVoidSketch = function (p) {
        let ambientSound, blinkSound;
        let eyelidOpen = true;
        let isBlinking = false;
        let angleBig = 0;
        let angleSmall = 0;
        let isMuted = false;

        p.preload = function () {
          // Ajustar las rutas para que sean relativas al proyecto
          p.soundFormats("mp3");
          ambientSound = p.loadSound(
            "./assets/proyectos/Programación y electrónica/Blink Void/Assets/ArturKordas_Baba.mp3"
          );
          blinkSound = p.loadSound(
            "./assets/proyectos/Programación y electrónica/Blink Void/Assets/Blink.mp3"
          );
        };

        p.setup = function () {
          let container = document.getElementById("blink-void-container");
          let canvas = p.createCanvas(
            container.offsetWidth,
            container.offsetHeight
          );
          canvas.parent("blink-void-container");

          // Reproducir sonido ambiente solo cuando el usuario interactúa por primera vez
          canvas.mousePressed(function () {
            if (!ambientSound.isPlaying() && !isMuted) {
              ambientSound.play();
              ambientSound.loop();
            }
          });

          // Configurar el botón de silenciar
          const muteButton = document.getElementById("mute-button");
          const muteIcon = document.getElementById("mute-icon");

          muteButton.addEventListener("click", function (event) {
            event.stopPropagation(); // Evitar que el clic se propague al canvas
            isMuted = !isMuted;

            if (isMuted) {
              // Silenciar
              muteIcon.className = "fas fa-volume-mute";
              if (ambientSound.isPlaying()) {
                ambientSound.stop(); // Usar stop() en lugar de pause() para detener completamente
              }
              // Asegurar que el sonido de parpadeo también esté silenciado
              blinkSound.setVolume(0);
            } else {
              // Desilenciar
              muteIcon.className = "fas fa-volume-up";
              // Restaurar el volumen del sonido de parpadeo
              blinkSound.setVolume(1);
              // Solo reproducir el sonido ambiente si no está sonando
              if (!ambientSound.isPlaying()) {
                ambientSound.play();
                ambientSound.loop();
              }
            }
          });
        };

        p.draw = function () {
          p.background("black");
          p.translate(p.width / 2, p.height / 2);
          p.strokeCap(p.ROUND);

          // Reset del parpadeo
          if (!eyelidOpen && !isBlinking) {
            eyelidOpen = true;
          }

          // Crear líneas y movimientos con cos y sin
          let radius = p.min(p.width, p.height) * 0.4;
          for (let i = 0; i < 16; i++) {
            let a = angleBig + i * 0.4;
            let x = p.cos(a) * radius;
            let y = p.sin(a) * radius;
            p.stroke("white");
            p.strokeWeight(7);
            p.line(0, 0, x, y);
          }

          let radiusSmall = radius * 0.8;
          for (let i = 0; i < 16; i++) {
            let a = angleSmall + i * 0.4;
            let x = p.cos(a) * radiusSmall;
            let y = p.sin(a) * radiusSmall;
            p.stroke("red");
            p.strokeWeight(7);
            p.line(0, 0, x, y);
          }

          // Círculo negro en medio
          p.fill("black");
          p.noStroke();
          p.ellipse(0, 0, radius * 0.7);

          // Ojo con curvas de bezier
          let eyeSize = radius * 0.5;
          p.stroke("white");
          p.fill("white");
          p.beginShape();
          p.vertex(-eyeSize / 2, 0);
          p.bezierVertex(
            -eyeSize / 6,
            -eyeSize / 3,
            eyeSize / 6,
            -eyeSize / 3,
            eyeSize / 2,
            0
          );
          p.bezierVertex(
            eyeSize / 6,
            eyeSize / 3,
            -eyeSize / 6,
            eyeSize / 3,
            -eyeSize / 2,
            0
          );
          p.endShape();

          // Pupilas
          p.fill("black");
          p.stroke("black");
          p.ellipse(0, 0, eyeSize / 3);
          p.fill("white");
          p.noStroke();
          p.ellipse(-eyeSize / 10, -eyeSize / 15, eyeSize / 10);

          p.stroke("white");
          p.fill("black");
          p.noStroke();

          // Párpados abiertos y cerrados
          if (eyelidOpen) {
            p.beginShape();
            p.vertex(-eyeSize / 2, 0);
            p.bezierVertex(
              -eyeSize / 2,
              -eyeSize / 3,
              eyeSize / 2,
              -eyeSize / 3,
              eyeSize / 2,
              0
            );
            p.bezierVertex(
              -eyeSize / 10,
              -eyeSize / 6,
              eyeSize / 10,
              -eyeSize / 6,
              -eyeSize / 2,
              0
            );
            p.endShape(p.CLOSE);
          } else {
            p.beginShape();
            p.vertex(-eyeSize / 2, 0);
            p.bezierVertex(
              -eyeSize / 6,
              -eyeSize / 3,
              eyeSize / 6,
              -eyeSize / 3,
              eyeSize / 2,
              0
            );
            p.bezierVertex(
              eyeSize / 6,
              eyeSize / 3,
              -eyeSize / 6,
              eyeSize / 3,
              -eyeSize / 2,
              0
            );
            p.endShape(p.CLOSE);
          }

          // Update movimiento de líneas
          angleSmall -= 0.003;
          angleBig += 0.003;
        };

        p.mouseClicked = function () {
          // Solo activar el parpadeo si el clic es dentro del canvas
          if (
            p.mouseX >= 0 &&
            p.mouseX <= p.width &&
            p.mouseY >= 0 &&
            p.mouseY <= p.height
          ) {
            if (!isBlinking) {
              eyelidOpen = false;
              isBlinking = true;
              if (!isMuted) {
                blinkSound.play();
              }
              setTimeout(function () {
                isBlinking = false; // Delay
              }, 200);
            }
          }
        };
      };

      // Iniciar el sketch de p5.js
      new p5(blinkVoidSketch);
    </script>

    <!-- Script principal del sitio -->
    <script src="script.js"></script>

    <!-- Script para manejar videos en el modal -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Obtener elementos del modal
        const modal = document.getElementById("imageModal");
        const modalImg = document.getElementById("modalImage");
        const modalVideo = document.getElementById("modalVideo");
        const closeBtn = document.getElementsByClassName("close")[0];
        const prevBtn = document.getElementsByClassName("prev")[0];
        const nextBtn = document.getElementsByClassName("next")[0];

        // Obtener todos los elementos de la galería (imágenes y videos)
        const galleryImages = document.querySelectorAll(".gallery-item img");
        const videoItems = document.querySelectorAll(".gallery-item video");

        // Añadir evento de clic a las imágenes
        galleryImages.forEach((img) => {
          img.addEventListener("click", function () {
            modal.style.display = "block";
            modalImg.style.display = "block";
            modalVideo.style.display = "none";
            modalImg.src = this.src;
            modalImg.alt = this.alt || "";

            // Actualizar el array de la galería
            updateGalleryArray();
          });
        });

        // Añadir evento de clic a los videos
        videoItems.forEach((video) => {
          video.addEventListener("click", function () {
            modal.style.display = "block";
            modalImg.style.display = "none";
            modalVideo.style.display = "block";
            modalVideo.src = this.querySelector("source").src;
            modalVideo.play();

            // Actualizar el array de la galería
            updateGalleryArray();
          });
        });

        // Modificar la función updateGalleryArray para incluir videos
        window.updateGalleryArray = function () {
          // Obtener todos los elementos de la galería actual
          const galleryContainers =
            document.querySelectorAll(".gallery-container");
          let currentGalleryContainer = null;

          // Encontrar el contenedor de galería visible
          for (let container of galleryContainers) {
            if (isElementInViewport(container)) {
              currentGalleryContainer = container;
              break;
            }
          }

          if (currentGalleryContainer) {
            // Obtener todas las imágenes y videos de la galería actual
            const galleryImages =
              currentGalleryContainer.querySelectorAll(".gallery-item img");
            const galleryVideos = currentGalleryContainer.querySelectorAll(
              ".gallery-item video"
            );

            // Crear un array combinado de elementos multimedia
            window.galleryArray = [];

            galleryImages.forEach((img) => {
              window.galleryArray.push({
                type: "image",
                src: img.src,
                alt: img.alt,
              });
            });

            galleryVideos.forEach((video) => {
              const source = video.querySelector("source");
              if (source) {
                window.galleryArray.push({
                  type: "video",
                  src: source.src,
                  poster: video.poster,
                });
              }
            });
          }
        };

        // Función auxiliar para verificar si un elemento está en el viewport
        function isElementInViewport(el) {
          const rect = el.getBoundingClientRect();
          return (
            rect.top >= 0 &&
            rect.left >= 0 &&
            rect.bottom <=
              (window.innerHeight || document.documentElement.clientHeight) &&
            rect.right <=
              (window.innerWidth || document.documentElement.clientWidth)
          );
        }

        // Modificar la función para navegar entre elementos
        function navigateGallery(direction) {
          if (!window.galleryArray || window.galleryArray.length === 0) return;

          // Encontrar el índice actual
          let currentIndex = -1;
          const currentSrc =
            modalVideo.style.display === "block"
              ? modalVideo.src
              : modalImg.src;

          for (let i = 0; i < window.galleryArray.length; i++) {
            // Comparar solo la parte final de la URL para evitar problemas con rutas absolutas vs relativas
            const itemSrc = window.galleryArray[i].src;
            if (
              currentSrc.endsWith(
                itemSrc.substring(itemSrc.lastIndexOf("/"))
              ) ||
              itemSrc.endsWith(
                currentSrc.substring(currentSrc.lastIndexOf("/"))
              )
            ) {
              currentIndex = i;
              break;
            }
          }

          if (currentIndex === -1) {
            // Si no se encontró, usar el primer elemento
            currentIndex = 0;
          }

          // Calcular el nuevo índice
          let newIndex =
            (currentIndex + direction + window.galleryArray.length) %
            window.galleryArray.length;
          const newItem = window.galleryArray[newIndex];

          // Mostrar el elemento correspondiente
          if (newItem.type === "image") {
            modalImg.style.display = "block";
            modalVideo.style.display = "none";
            modalVideo.pause();
            modalImg.src = newItem.src;
            modalImg.alt = newItem.alt || "";
          } else if (newItem.type === "video") {
            modalImg.style.display = "none";
            modalVideo.style.display = "block";
            modalVideo.src = newItem.src;
            modalVideo.play();
          }
        }

        // Asignar la función de navegación a los botones
        prevBtn.onclick = function () {
          navigateGallery(-1);
        };
        nextBtn.onclick = function () {
          navigateGallery(1);
        };

        // Cerrar el modal y detener el video si está reproduciéndose
        closeBtn.onclick = function () {
          modal.style.display = "none";
          if (modalVideo.style.display === "block") {
            modalVideo.pause();
          }
        };

        // Cerrar el modal al hacer clic fuera de la imagen/video
        modal.onclick = function (event) {
          if (event.target === modal) {
            modal.style.display = "none";
            if (modalVideo.style.display === "block") {
              modalVideo.pause();
            }
          }
        };

        // Manejar teclas de navegación
        document.addEventListener("keydown", function (event) {
          if (modal.style.display === "block") {
            if (event.key === "ArrowLeft") {
              navigateGallery(-1);
            } else if (event.key === "ArrowRight") {
              navigateGallery(1);
            } else if (event.key === "Escape") {
              modal.style.display = "none";
              if (modalVideo.style.display === "block") {
                modalVideo.pause();
              }
            }
          }
        });
      });
    </script>
  </body>
</html>
